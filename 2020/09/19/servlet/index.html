<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-flash.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/avatar1.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/avatar1.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/avatar1.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Servlet," />










<meta name="description" content="概念两种架构1. C&#x2F;S架构和B&#x2F;S架构     C&#x2F;S：Client&#x2F;Server，客户端和服务器         * 必须在客户端安装特定软件         * 图形显示效果好，但是在服务器的软件和功能升级的时候，客户端也必须一起升级      B&#x2F;S: Brower&#x2F;Server，浏览器和服务器         * 无需安装客户端，任何浏览器都可以进行访问         * 涉及到升级的">
<meta property="og:type" content="article">
<meta property="og:title" content="Servlet">
<meta property="og:url" content="http://print3306.github.io/2020/09/19/servlet/index.html">
<meta property="og:site_name" content="浊酒一杯">
<meta property="og:description" content="概念两种架构1. C&#x2F;S架构和B&#x2F;S架构     C&#x2F;S：Client&#x2F;Server，客户端和服务器         * 必须在客户端安装特定软件         * 图形显示效果好，但是在服务器的软件和功能升级的时候，客户端也必须一起升级      B&#x2F;S: Brower&#x2F;Server，浏览器和服务器         * 无需安装客户端，任何浏览器都可以进行访问         * 涉及到升级的">
<meta property="og:image" content="http://print3306.github.io/2020/09/19/servlet/cookie1.png">
<meta property="og:image" content="http://print3306.github.io/2020/09/19/servlet/cookie2.png">
<meta property="og:image" content="http://print3306.github.io/2020/09/19/servlet/cookie_setting.png">
<meta property="og:image" content="http://print3306.github.io/2020/09/19/servlet/charset.png">
<meta property="og:image" content="http://print3306.github.io/2020/09/19/servlet/encode_decode.png">
<meta property="og:image" content="http://print3306.github.io/2020/09/19/servlet/session_exp_1.png">
<meta property="og:image" content="http://print3306.github.io/2020/09/19/servlet/session_exp_2.png">
<meta property="og:image" content="http://print3306.github.io/2020/09/19/servlet/request_session.png">
<meta property="og:image" content="http://print3306.github.io/2020/09/19/servlet/redirect_forward.png">
<meta property="og:image" content="http://print3306.github.io/2020/09/19/servlet/cookie_session.png">
<meta property="og:image" content="http://print3306.github.io/2020/09/19/servlet/servletcontext_count.png">
<meta property="og:image" content="http://print3306.github.io/2020/09/19/servlet/filter_exe.png">
<meta property="og:image" content="http://print3306.github.io/2020/09/19/servlet/errors_01.png">
<meta property="article:published_time" content="2020-09-19T09:06:12.000Z">
<meta property="article:modified_time" content="2020-10-16T08:23:32.705Z">
<meta property="article:author" content="浊酒一杯">
<meta property="article:tag" content="Servlet">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://print3306.github.io/2020/09/19/servlet/cookie1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://print3306.github.io/2020/09/19/servlet/"/>





  <title>Servlet | 浊酒一杯</title>
  








<meta name="generator" content="Hexo 4.2.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">浊酒一杯</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>

<script>
    
    window.onload = function(){
        var path = 'https://malizhi.cn'; //这里要改成你博客的地址
        var localhostItem = String(window.location).split(path)[1];
        var LiNode = document.querySelectorAll('#menu > li > a')
        
        for(var i = 0; i< LiNode.length;i++){
            var item = String(LiNode[i].href).split(path)[1];
            if(item == localhostItem && item != undefined){
                LiNode[i].setAttribute('style','border-bottom:1px solid black');
            }
        }
    };

 </script>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://print3306.github.io/2020/09/19/servlet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="浊酒一杯">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar1.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="浊酒一杯">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Servlet</h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-09-19T17:06:12+08:00">
                2020-09-19
              </time>
            

            
              <span class="post-meta-divider">|</span>
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-check-o"></i>
              </span>
              
                <span class="post-meta-item-text">更新于&#58;</span>
              
              <time title="更新于" itemprop="dateModified" datetime="2020-10-16T16:23:32+08:00">
                2020-10-16
              </time>
            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Servlet/" itemprop="url" rel="index">
                    <span itemprop="name">Servlet</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  7.4k
                </span>
              

              

              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h2><h3 id="两种架构"><a href="#两种架构" class="headerlink" title="两种架构"></a>两种架构</h3><pre><code>1. C/S架构和B/S架构
    C/S：Client/Server，客户端和服务器
        * 必须在客户端安装特定软件
        * 图形显示效果好，但是在服务器的软件和功能升级的时候，客户端也必须一起升级

    B/S: Brower/Server，浏览器和服务器
        * 无需安装客户端，任何浏览器都可以进行访问
        * 涉及到升级的，只需要升级服务器就可以了
        * 需要使用HTTP协议</code></pre><h3 id="服务器简介"><a href="#服务器简介" class="headerlink" title="服务器简介"></a>服务器简介</h3><pre><code>1. 什么是web？
    Web（World Wide Web）称为万维网，简单理解就是网站，表示internet主机上供外界访问的资源。
    资源分类：
        * 静态资源：Web页面中供人们浏览的数据始终是不变的。（HTML,CSS）
        * 动态资源：Web页面中人们浏览的数据是根据程序产生的，不同的时间，甚至不同的设备访问看到的内容是不同的。（JSP,Servlet）

2. 什么是Web服务器？
    Web服务器是运行以及发布Web应用的一个容器，只有将开发的Web项目放置到该容器中，才能使网络中的用户通过浏览器访问。

3. 常见服务器
    * 开源：
        1. Tomcat,主流的服务器之一
        2. jetty,淘宝的使用
        3. resin,效率最高的
        用法相同，只有开启和关闭服务器的命令上有差别

4. Tomcat服务器：
    * Apache软件基金会的Jakarta的一个核心项目，免费开源，支持JSP和servlet规范。
    * 技术先进，性能稳定，比较主流的Web服务器

    1. 下载安装

    2. Tomcat的目录结构
        1. bin: 二进制可执行文件
        2. conf:
            * server.xml,Tomcat服务器的配置信息，修改端口号，字符编码等
            * web.xml，项目部署描述文件
        3. lib: Tomcat的类库，jar包，服务器运行需要的jar包
        4. logs: 日志文件
        5. temp: 临时文件，Tomcat停止后可以删除
        6. webapps: 所有部署的项目，每个文件夹都是一个项目，ROOT是一个特殊的项目，在没有写地址栏时，对应的就是ROOT项目。
        7. work: 运行生成的文件，最终运行的文件都在这里

    3. Tomcat的启动
        * 在安装目录下的bin,双击startup.bat,显示毫秒数，启动成功
        * 在浏览器内输入，http://localhost:8080,出现页面，则显示成功

    4. 停止Tomcat
        双击shutdown.bat即可关闭

    5. 修改默认端口号
        在conf文件夹的内部，打开server.xml,找到&lt;connector&gt;标签，可以修改默认端口号
        修改后，重启Tomcat可以使用修改后的端口

    6. 项目部署的访问静态资源
        Tomcat是Web服务器，项目存在于webapps内部，通过特定的URL访问

        * 创建项目
            在webapps中建立文件夹，myapp
                - 创建WEB—INF，存放项目的核心内容
                    * 创建.classes文件夹，存放.class文件
                    * 创建lib,存放jar文件
                    * 创建web.xml，项目配置文件
                - 静态资源，与WEB—INF同级目录

        * URL访问资源
            在浏览器输入：http://localhost:8080/myapp/hello.html,可以访问到资源

    7. Tomcat的响应流程
        一旦用户访问，服务器会到webapps查找对应的资源文件，找到之后，回响应用户请求，显示对应的资源文件


    8. Tomcat的常见错误
        * Tomcat闪退
            JAVA_HOME配置是否有问题

        * 404
            服务器访问资源不存在，产生404</code></pre><h2 id="Servlet"><a href="#Servlet" class="headerlink" title="Servlet"></a>Servlet</h2><h3 id="Servlet的基础概念"><a href="#Servlet的基础概念" class="headerlink" title="Servlet的基础概念"></a>Servlet的基础概念</h3><pre><code>1. 含义
    * Server Applet的简称，是服务器端的程序（代码，功能实现），可交互式的处理客户端发送到服务器的请求，并完成响应操作。
    * 动态网页技术

2. 作用
    * 接收客户端发送的请求，并完成相应的操作
    * 动态生成网页
    * 将包含操作结果的网页响应给客户端</code></pre><h3 id="Servlet开发步骤"><a href="#Servlet开发步骤" class="headerlink" title="Servlet开发步骤"></a>Servlet开发步骤</h3><pre><code>1. 搭建开发环境
    将Servlet相关的jar包(lib/servlet-api.jar)导入classpath中

2. 编写Servlet的实现类
    * 实现javax.servlet.Servlet接口
    * 重写方法
    * 在service()核心编写语句

3. 将编译生成的.class文件放在WEB-INF/classes文件下
4. 修改web.xml的配置信息</code></pre><blockquote>
</blockquote>
<pre><code>&lt;servlet&gt;
&lt;!-- 为指定的class起别名 --&gt;
  &lt;servlet-name&gt;my&lt;/servlet-name&gt;
  &lt;servlet-class&gt;MyServlet&lt;/servlet-class&gt;
&lt;/servlet&gt;
&lt;!-- 访问资源的映射。使用/来访问MyServlet资源 --&gt;
&lt;servlet-mapping&gt;
  &lt;servlet-name&gt;my&lt;/servlet-name&gt;
  &lt;!-- 访问路径，浏览器的访问路径 --&gt;
  &lt;url-patten&gt;/&lt;/url-patten&gt;
&lt;/servlet-mapping&gt;

url-patten:配置的内容就是浏览器地址栏输入的URL项目名称后资源的内容

5. 错误
    500 ：服务器端错误</code></pre><h3 id="使用IDEA开发部署Servlet"><a href="#使用IDEA开发部署Servlet" class="headerlink" title="使用IDEA开发部署Servlet"></a>使用IDEA开发部署Servlet</h3><pre><code>1. 步骤
    * 创建项目，选择Java EE 7，并勾选Web Application
    * 输入项目名称和保存位置，点击Finsh，完成项目创建

2. 文件目录结构
    * .idea: 项目配置文件
    * src:存放Java代码
    * web : 存放静态资源
        WEB-INF:项目配置文件，classes和jar文件
            web.xml:
        index.jsp:动态页面

3. 使用方式
    * 导入外部jar包，servlet-api.jar
    * 重写实现类实现Servlet接口
    * 将访问路径进行绑定，使用servlet 和 servlet-mapping进行路径绑定
    * 开启服务，进行结果查看

4. IDEA集成Tomcat服务器
    * File -&gt; Setting -&gt; ApplicatioServices -&gt; + ,导入Tomcat的解压缩位置
    * 点击Edit Configurations,将项目放置到Deployment中
    * 开启Tomcat

5. 手动导入第三方jar包
    * 在web目录下，WEB-INF建立lib文件夹，将需要导入的jar包复制，然后点击lib目录，使用右键，Add As Librarys

6. 导出war包
    * 项目完成后，可以打包成war包，将其放在Tomcat的webapps目录下，一旦开启服务器，可以自动解压，实现项目部署。
    * 步骤：
        1. Project Structure -&gt; Artifacts -&gt; + -&gt; Web Application:Archive -&gt; For 
        2. 构建项目，bulid -&gt; bulid Artifacts
        3. 会在项目的out文件夹下生成，war包，将该包复制到webapps中，在再次开启服务器时，会将该项目解压，部署

7. 热部署
    在不进行服务器重启的前提现，进行数据的更新
    整个项目从新部署，包括从新打上.war 文件。会清空session ，释放内存。

    * war包，项目最终完成，将其放在服务器的文件目录下，可以实现启动服务器的同时部署项目
    * IDEA的开发工具集成Tomcat,编译项目时，生成的文件会放置在out文件夹中，再次刷新浏览器，会得到最新的信息</code></pre><h2 id="HTTP协议"><a href="#HTTP协议" class="headerlink" title="HTTP协议"></a>HTTP协议</h2><h3 id="HTTP"><a href="#HTTP" class="headerlink" title="HTTP"></a>HTTP</h3><pre><code>1. 含义
    超文本传输协议（HyperText Transfer Protocol），是互联网的一种网络协议
    基于请求与响应模式的，无状态的，应用层的协议，运行于TCP协议之上

2. 特点    
    * 由于是基于请求和响应的，可以支持浏览器/服务器模式
    * 简单快速：
        客户端只向服务器发送请求方法和路径，服务器就可以发送响应数据，通信速度很快，请求的方法有GET,POST
    * 灵活：可以传输不同类型的数据
    * 无连接的：每次TCP连接只处理一个请求或多个，服务器处理完客户端的请求之后，会断开连接，可以减少开销
    * 无状态的：HTTP协议对于事务没有记忆能力

3. HTTP通信流程
    1. 客户端与服务器建立TCP连接（三次握手）
    2. 客户端发送请求
    3. 服务器接受请求，并响应
    4. 客户端与服务器关闭连接（四次挥手）

4. 请求报文
    当浏览器向服务器发出请求时，向服务器传递一个数据块，就是请求报文
    * 请求行 请求方法/地址 URI协议/版本
    * 请求头 Request Header：可以接受的数据，语言，端口号，以及当前浏览器信息    
    * 空行
    * 请求正文    

5. 响应报文
    当服务器响应浏览器的请求，向浏览器传递一个数据块，就是响应报文
    * 状态行 
    * 响应头 Respone Header
    * 空行
    * 响应正文    

6. 常见状态码</code></pre><table>
<thead>
<tr>
<th align="center">状态编码</th>
<th align="center">状态描述</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">200</td>
<td align="center">OK</td>
<td align="center">客户端请求成功</td>
</tr>
<tr>
<td align="center">302</td>
<td align="center">Found</td>
<td align="center">临时重定向</td>
</tr>
<tr>
<td align="center">403</td>
<td align="center">Forbidden</td>
<td align="center">服务器收到请求，但是拒绝提供服务，在正文中给原因</td>
</tr>
<tr>
<td align="center">404</td>
<td align="center">Not Found</td>
<td align="center">请求的资源不存在</td>
</tr>
<tr>
<td align="center">500</td>
<td align="center">Internal Server Error</td>
<td align="center">服务器错误，无法完成请求</td>
</tr>
</tbody></table>
<h2 id="Servlet深入"><a href="#Servlet深入" class="headerlink" title="Servlet深入"></a>Servlet深入</h2><h3 id="Servlet核心接口和类"><a href="#Servlet核心接口和类" class="headerlink" title="Servlet核心接口和类"></a>Servlet核心接口和类</h3><pre><code>1. Servlet的实现类
    * 通过实现Servlet接口创建Servlet类
    * 继承GenericServlet类
    * 继承HttpServlet类

2.1 Servlet接口
    Servlet是Servlet API的最重要的接口，所有的Servlet都会与该接口相关联，或是直接实现该接口，或是间接继承该接口的实现类

    接口中的方法：
    void init()
    ServletConfig getServletConfig()
    void service(ServletRequest request,ServletRespone respone)
    String getServletInfo()
    void destroy()

2.2 GenericServlet抽象类
    提供了生命周期方法init和destroy的实现方法，我们只需要实现service方法就可以
    实现了Servlet接口，重写了除了service()之外的所有方法
    一旦我们继承了该抽象类，只需要重写该方法就行

2.3 HttpServlet抽象类
    具体处理HTTP协议服务器端程序，继承了GenericServlet抽象类，重写了service()方法，针对HTTP协议的抽象类
    doGet,doPost,doPut,doDelete等方法</code></pre><h3 id="Servlet的创建方式"><a href="#Servlet的创建方式" class="headerlink" title="Servlet的创建方式"></a>Servlet的创建方式</h3><pre><code>1. 实现Servlet的接口</code></pre><blockquote>
</blockquote>
<pre><code>public class MyServlet implements Servlet { 
@Override
public void init(ServletConfig servletConfig) throws ServletException {

}

@Override
public ServletConfig getServletConfig() {
    return null;
}

@Override
public void service(ServletRequest servletRequest, ServletResponse servletResponse) throws ServletException, IOException {
    System.out.println(new Date());
}

@Override
public String getServletInfo() {
    return null;
}

@Override
public void destroy() {

}</code></pre><p>}</p>
<pre><code>2. 继承HttpServlet抽象类（推荐）</code></pre><blockquote>
<pre><code>可以重写doGet,doPost，对访问进行修改
public class MyServlet3 extends HttpServlet {
    可以重写Http访问有关的方法
    doGet,doPost
}</code></pre></blockquote>
<pre><code>3. 常见错误
    1. 404:未找到资源
        * 地址书写错误
        * 地址没有问题，将IDEA的out目录删除，然后重新运行
    2. servlet地址重复
        * both mapped to the url-patten which is not permitted
    3. servlet配置地址错误</code></pre><h3 id="Servlet的配置方式"><a href="#Servlet的配置方式" class="headerlink" title="Servlet的配置方式"></a>Servlet的配置方式</h3><pre><code>1. 使用web.xml（2.5之前）</code></pre><blockquote>
<pre><code>&lt;!-- 建立访问映射 --&gt;
  &lt;servlet&gt;
    &lt;!-- 名称 --&gt;
    &lt;servlet-name&gt;servlet&lt;/servlet-name&gt;
    &lt;!-- 全限定类名 --&gt;
    &lt;servlet-class&gt;com.servlet_02_start.servlet.MyServlet&lt;/servlet-class&gt;
    &lt;!-- 启动时加载 --&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
  &lt;/servlet&gt;
  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;servlet&lt;/servlet-name&gt;
    &lt;url-pattern&gt;/start&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;</code></pre></blockquote>
<pre><code>url-patten的匹配规则：</code></pre><table>
<thead>
<tr>
<th align="center">含义</th>
<th align="center">具体</th>
<th align="center">触发时机</th>
</tr>
</thead>
<tbody><tr>
<td align="center">精确匹配</td>
<td align="center">/具体的名称</td>
<td align="center">只有url路径是具体的名称的时候才会出发Servlet</td>
</tr>
<tr>
<td align="center">后缀匹配</td>
<td align="center">*.xxx</td>
<td align="center">只要是以xxx结尾的就匹配</td>
</tr>
<tr>
<td align="center">通配匹配符</td>
<td align="center">/*</td>
<td align="center">匹配所有的请求,包括服务器的所有资源</td>
</tr>
<tr>
<td align="center">通配匹配符</td>
<td align="center">/</td>
<td align="center">匹配所有的请求,包括服务器的所有资源,不包括.jsp</td>
</tr>
<tr>
<td align="center">&gt;   <strong>通配符的匹配并不影响精确匹配的结果</strong></td>
<td align="center"></td>
<td align="center"></td>
</tr>
</tbody></table>
<pre><code>load-on-startup标签
    * 元素标记容器是否在web应用启动的时候加载servlet
    * 值必须是整数，值越小，优先级越高，加载的时机越早，表示在初始化时被加载的顺序
    * 如果不写或者是负数，表示在servlet被使用的时候加载
    * 如果值相同，则按照顺序加载servlet,0优先级最高

2. 使用注解配置（Servlet3.0之后）
    类名之上添加，不用在.xml中配置
    @WebServlet注解
        属性：
            * name:servlet的名称，可以不写
            * value:配置url路径，可以配置多个
            * urlPattens:配置url路径，与value作用相同，但不能同时使用
            * loadOnStartup:表示配置创建servlet的时间，默认-1，表示在访问的时候创建

注解和web.xml之间没有冲突</code></pre><h2 id="Servlet应用"><a href="#Servlet应用" class="headerlink" title="Servlet应用"></a>Servlet应用</h2><h3 id="Request对象"><a href="#Request对象" class="headerlink" title="Request对象"></a>Request对象</h3><pre><code>获取客户端请求，所有的客户端的请求数据都存在于Request对象里</code></pre><h4 id="get请求"><a href="#get请求" class="headerlink" title="get请求"></a>get请求</h4><pre><code>1. get提交的数据会放在URL之后，以?分隔，URL和数据，参数之间以&amp;连接
2. get方式明文传递，数据量小，不安全
3. 效率高，浏览器默认为GET请求
4. 对应的方法为GET</code></pre><h4 id="post请求"><a href="#post请求" class="headerlink" title="post请求"></a>post请求</h4><pre><code>1. post请求把提交的数据放在HTTP的Body中
2. post密文传输，数据量大，安全
3. 效率相对不高
4. 对应的Servlet方法是doPost</code></pre><h4 id="Request的常用方法"><a href="#Request的常用方法" class="headerlink" title="Request的常用方法"></a>Request的常用方法</h4><pre><code>1. 方法</code></pre><table>
<thead>
<tr>
<th align="center">方法名</th>
<th align="center">参数</th>
<th align="center">含义</th>
</tr>
</thead>
<tbody><tr>
<td align="center">String getParameters(String name)</td>
<td align="center">组件名称</td>
<td align="center">根据表单组件名称获取数据</td>
</tr>
<tr>
<td align="center">void setCharacterEncoding(String chaset)</td>
<td align="center">设置字符编码</td>
<td align="center">指定请求的编码</td>
</tr>
</tbody></table>
<h4 id="Request的应用"><a href="#Request的应用" class="headerlink" title="Request的应用"></a>Request的应用</h4><pre><code>1. 从表单中使用get方法获取数据</code></pre><blockquote>
<pre><code>protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
    //1.获取用户的请求
    String username = req.getParameter(&quot;username&quot;);
    String password = req.getParameter(&quot;password&quot;);
    System.out.println(&quot;username:&quot;+username+&quot;  --&gt; &quot;+&quot;password:&quot;+password);
}
&lt;form action=&quot;register&quot; method=&quot;get&quot;&gt;
    用户名:&lt;label&gt;
    &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;
&lt;/label&gt;&lt;br/&gt;
    密码:&lt;label&gt;
    &lt;input type=&quot;password&quot; name=&quot;password&quot;/&gt;
&lt;/label&gt;&lt;br/&gt;
    &lt;input type=&quot;submit&quot; value=&quot;注册&quot;/&gt;
&lt;/form&gt;</code></pre></blockquote>
<pre><code>通过浏览器的内容可看出，使用get方法提交的数据是明文，以?分隔URL和数据，以&amp;拼接参数

问题：get方法参数乱码
    客户端和服务器端的编码不一致，可以使用统一的编码格式，按照此编码进行数据的传输和接受

    Tomcat的7以及以下版本，客户端以UTF-8的编码格式进行数据传输，服务器以ISO8859-1的字符编码来接收数据，两边的编码方式不一样，导致乱码问题。

    可以在服务器接受收数据的时候以IOS8859-1来接收，在进行编码转换

    Tomcat的8版本解决了get方法的乱码问题

2. 使用post方法获取数据</code></pre><blockquote>
<pre><code>protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
  //设置统一编码
  req.setCharacterEncoding(&quot;UTF-8&quot;);     
    //1.获取用户的请求
    String username = req.getParameter(&quot;username&quot;);
    String password = req.getParameter(&quot;password&quot;);
    System.out.println(&quot;username:&quot;+username+&quot;  --&gt; &quot;+&quot;password:&quot;+password);
}
&lt;form action=&quot;register&quot; method=&quot;get&quot;&gt;
    用户名:&lt;label&gt;
    &lt;input type=&quot;text&quot; name=&quot;username&quot;&gt;
&lt;/label&gt;&lt;br/&gt;
    密码:&lt;label&gt;
    &lt;input type=&quot;password&quot; name=&quot;password&quot;/&gt;
&lt;/label&gt;&lt;br/&gt;
    &lt;input type=&quot;submit&quot; value=&quot;注册&quot;/&gt;
&lt;/form&gt;</code></pre></blockquote>
<pre><code>通过浏览器的内容可看出，使用post方法提交的数据没有出现数据信息,只有接受的路径名称，更安全

问题：post中文乱码
    客户端的编码格式为UTF-8,在post使用的时候，将服务器的编码格式转化为UTF-8
    使用ServletRequest的setCharacterEncoding设置编码</code></pre><h2 id="Respone对象"><a href="#Respone对象" class="headerlink" title="Respone对象"></a>Respone对象</h2><pre><code>响应客户端请求，并向客户端输出信息    </code></pre><h3 id="Resopne的主要方法"><a href="#Resopne的主要方法" class="headerlink" title="Resopne的主要方法"></a>Resopne的主要方法</h3><table>
<thead>
<tr>
<th>方法名称</th>
<th>作用</th>
</tr>
</thead>
<tbody><tr>
<td>setHeader(name,value)</td>
<td>设置响应信息头</td>
</tr>
<tr>
<td>setContentType(String)</td>
<td>设置响应文件类型,文件编码</td>
</tr>
<tr>
<td>setCharacterEncoding(String)</td>
<td>设置响应编码</td>
</tr>
<tr>
<td>getWriter()</td>
<td>获取字符输出流,返回数据</td>
</tr>
</tbody></table>
<h4 id="响应数据给客户端"><a href="#响应数据给客户端" class="headerlink" title="响应数据给客户端"></a>响应数据给客户端</h4><blockquote>
<pre><code>//响应数据给客户端
  resp.setCharacterEncoding(&quot;UTF-8&quot;);
  PrintWriter printWriter = resp.getWriter();
  printWriter.println(&quot;OK&quot;)</code></pre></blockquote>
<pre><code>问题：出现中文乱码
    和Request的乱码原因相同
    1. 方法一
    * 使用setCharacterEncoding(&quot;UTF-8&quot;)方法来进行服务端编码格式设置
    * 使用setHeader(&quot;Content-type&quot;,&quot;text/html;charset=UTF-8&quot;);
    2. 方法二
    * setContentType(&quot;text/html;charset=UTF-8&quot;),同时设置文件类型和编码格式，必须在获取输出流之前使用</code></pre><h2 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h2><pre><code>问题
1. 在servlet中，调用业务逻辑和显示页面都在同一个servlet中，职能不单一，不利于后期维护
2. 可以将业务逻辑和显示信息分离

单独写类进行业务逻辑，和显示信息的打印
XxxController extend HttpServlet
XxxJsp extend HttpServlet

如何跳转到JSP
如何将查询到的数据传送给展示的servlet</code></pre><h3 id="转发（request）"><a href="#转发（request）" class="headerlink" title="转发（request）"></a>转发（request）</h3><pre><code>转发的作用在服务器端，将请求发送给服务器的其他资源，共同完后一次请求</code></pre><h4 id="页面跳转"><a href="#页面跳转" class="headerlink" title="页面跳转"></a>页面跳转</h4><pre><code>1. 页面跳转实现
    在调用业务逻辑的servlet中，编写
        request.getRequestDispatcher(&quot;/目标url-patten&quot;).forward(request,respone)

    页面跳转属于同一次请求，客户端察觉不到转发的过程，在服务器内部进行跳转，地址栏不发生改变</code></pre><h4 id="数据传递"><a href="#数据传递" class="headerlink" title="数据传递"></a>数据传递</h4><pre><code>1. forword表示同一次请求，在服务器内部内部跳转，可以共享同一次request作用域的数据

2. request作用域: 拥有存储数据的空间，作用范围是一次请求(可以进行多次转发)
    * 可以将数据存储到request内部，在一次请求的内部进行数据传递，任意位置获取数据
    * 可以传递任意数据类型(基本数据类型，对象，集合等)

3. request数据存储：以键值对存储数据
    * request.setAttribute(key,value)：key，String类型，value,Object类型
    * 将数据以键值对的方式存储在数据空间内部

4. 获取数据
    * request.getAttribute(key)
    * 通过String类型的key访问value
    * 需要转换数据类型</code></pre><h4 id="转发的注意事项"><a href="#转发的注意事项" class="headerlink" title="转发的注意事项"></a>转发的注意事项</h4><pre><code>1. 转发是服务器的行为
2. 转发浏览器只有一次请求
3. 浏览器地址不变
4. 转发两次的跳转信息不会丢失，可以使用request作用域传递数据
5. 转发只能将请求转发给同一个web中的组件</code></pre><h3 id="重定向"><a href="#重定向" class="headerlink" title="重定向"></a>重定向</h3><pre><code>重定向作用在客户端，客户端将请求发送给服务器之后，服务器响应给客户端一个新的请求地址，客户端重新发送请求</code></pre><h4 id="页面跳转-1"><a href="#页面跳转-1" class="headerlink" title="页面跳转"></a>页面跳转</h4><pre><code>1. 实现
    * respone.sendRedirect(&quot;目标URI&quot;)
    * 表示服务器中的一个资源，资源在服务器中的路径(/项目/资源)

    客户端做了两次请求，地址栏发生了改变</code></pre><h4 id="数据传递-1"><a href="#数据传递-1" class="headerlink" title="数据传递"></a>数据传递</h4><pre><code>1. sendRedirect跳转时，地址栏发生改变，代表客户端重新发送的请求，属于两次请求

2. respone没有作用域，两次的request数据无法共享

3. 传递数据：
    使用拼接字符串进行数据传递(&quot;/webproject/b&quot;+&quot;?name=1&amp;password=1&quot;)

4. 获取数据
    使用request.getParameters,只能是string的数据类型</code></pre><h4 id="重定向注意实项"><a href="#重定向注意实项" class="headerlink" title="重定向注意实项"></a>重定向注意实项</h4><pre><code>1. 客户端的行为
2. 浏览器有两次请求
3. 浏览器地址栏发生改变
4. 两次跳转的传输信息会丢失(request范围)
5. 重定向可以指向任意资源，包括其他站点的资源</code></pre><h2 id="Servlet的生命周期"><a href="#Servlet的生命周期" class="headerlink" title="Servlet的生命周期"></a>Servlet的生命周期</h2><h3 id="生命周期的四个阶段"><a href="#生命周期的四个阶段" class="headerlink" title="生命周期的四个阶段"></a>生命周期的四个阶段</h3><h4 id="实例化"><a href="#实例化" class="headerlink" title="实例化"></a>实例化</h4><pre><code>1. 当用户第一次访问servlet时，由容器调用servlet的构造方法创建servlet对象，也可以在容器启动之后进行创建，使用load_on_startup可以控制对象的创建时间    
2. 只进行一次实例化</code></pre><h4 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h4><pre><code>1. 在初始化阶段，init()被调用，方法定义在javax.servlet.Servlet的接口中，以servletConfig对象作为参数
2. init()只执行一次</code></pre><h4 id="服务"><a href="#服务" class="headerlink" title="服务"></a>服务</h4><pre><code>1. 当客户端有一个请求，容器就会将ServletRequest与响应ServletRespone转给对应的servlet对象，以参数的形式传给service()
2. service()执行多次</code></pre><h4 id="死亡"><a href="#死亡" class="headerlink" title="死亡"></a>死亡</h4><pre><code>1. 当容器停止或者重新启动都会销毁servlet对象
2. destroy()执行一次</code></pre><h3 id="Servlet的特性"><a href="#Servlet的特性" class="headerlink" title="Servlet的特性"></a>Servlet的特性</h3><h4 id="线程安全问题"><a href="#线程安全问题" class="headerlink" title="线程安全问题"></a>线程安全问题</h4><pre><code>1. 问题
    servlet对象只创建一个实例对象，类似于单例模式，而Tomcat服务器容器可以同时多个线程并发访问同一个servlet,如果某个线程对成员变量进行修改，会造成线程安全问题

2. 解决线程安全问题
    * synchronized同步锁
        将存在线程安全问题的代码放入synchroized内部

        但是servlet只进行一次实例化，在线程进行访问的时候，对业务进行上锁，多个其他线程会等待释放锁，效率比较低

    * 实现SingleThreadModel接口
        servlet实现SingleThreadModel接口，每个线程会创建自己的servlet实例，请求不存在资源共享的问题，没有线程安全问题，但是servlet已经不使用

    * 使用局部变量，防止共享资源的出现
        推荐使用局部变量进行数据操作</code></pre><h2 id="状态管理"><a href="#状态管理" class="headerlink" title="状态管理"></a>状态管理</h2><h3 id="现有问题"><a href="#现有问题" class="headerlink" title="现有问题"></a>现有问题</h3><pre><code>1. HTTP协议是无状态的，不能保存每次提交的信息
2. 如果用户发来一个新的请求，服务器无法知道是否与上次的请求有关
3. 如果需要多次进行请求的操作，没有关联，难以进行下去</code></pre><h3 id="状态管理的概念"><a href="#状态管理的概念" class="headerlink" title="状态管理的概念"></a>状态管理的概念</h3><pre><code>将浏览器与web服务器的多次交互当作一个整体来处理，并且将多次的交互数据保存下来</code></pre><h3 id="状态管理的分类"><a href="#状态管理的分类" class="headerlink" title="状态管理的分类"></a>状态管理的分类</h3><pre><code>1. 客户端状态管理：
    将状态保存在客户端：Cookie
2. 服务器状态管理：
    将状态保存在服务端：Session</code></pre><h2 id="Cookie的使用"><a href="#Cookie的使用" class="headerlink" title="Cookie的使用"></a>Cookie的使用</h2><h3 id="什么是Cookie"><a href="#什么是Cookie" class="headerlink" title="什么是Cookie"></a>什么是Cookie</h3><pre><code>1. Cookie是浏览器访问Web服务器的某个资源时，由web服务器在HTTP响应消息头中附带传送给浏览器的一小段数据(服务器创建，保存在浏览器端)
2. 一旦Web浏览器保存了某个Cookie，在每次访问该web服务器都应该将这个cookie附加在HTTP请求头上回传给服务器
3. 一个Cookie主要由标识该信息的名称和值组成(key:value)

Cookie的原理
    * 在浏览器首次连接服务器，并得到服务器的响应数据，由服务器创建一个Cookie响应给浏览器，浏览器将响应的Cookie进行存储
    * 在以后的请求中，每次的请求数据中都会增加Cookie数据，而服务器收到请求后会首先进行Cookie的比对，如果存在Cookie,就获取Cookie，进行下面的操作</code></pre><h3 id="创建Cookie"><a href="#创建Cookie" class="headerlink" title="创建Cookie"></a>创建Cookie</h3><pre><code>1. 创建Cookie</code></pre><blockquote>
<pre><code>//1.创建Cookie对象
  Cookie ck = new Cookie(&quot;zxl&quot;,&quot;123456&quot;);
//2.将Cookie响应给浏览器
  resp.addCookie(ck);</code></pre></blockquote>
<blockquote>
</blockquote>
<p><img src="/2020/09/19/servlet/cookie1.png" alt="cookie在浏览器"><br><img src="/2020/09/19/servlet/cookie2.png" alt="cookie在浏览器2"></p>
<pre><code>2. 常用的设置：
    1. setPath()：指定可以获取Cookie的路径
    2. setMaxAge():设置生命周期    
        * &gt;0:设置过期时间，以秒为单位，不随浏览器的关闭而结束
        * =0:浏览器关闭,Cookie结束
        * &lt;0:浏览器临时存储，一旦内存清理或者浏览器关闭，就不存在，默认-1</code></pre><p><img src="/2020/09/19/servlet/cookie_setting.png" alt="Cookie的设置"></p>
<h3 id="获取Cookie"><a href="#获取Cookie" class="headerlink" title="获取Cookie"></a>获取Cookie</h3><pre><code>获取Cookie必须包含创建cookie对象时允许访问的的路径，即在创建cookie的setPath</code></pre><blockquote>
<pre><code>//获取Cookie
Cookie[] cookies = req.getCookies()；
//2.获取需要的cookies
if(cookies != null){
   for(Cookie cookie:cookies){
      System.out.println(&quot;cookie&quot;+cookie.getName()+&quot;---&gt;&quot;+cookie.getValue());
   }
}</code></pre></blockquote>
<h3 id="修改Cookie"><a href="#修改Cookie" class="headerlink" title="修改Cookie"></a>修改Cookie</h3><pre><code>只需要保证Cookie的名称和路径一致，就可以覆盖原来的cookie，只是名称一样的，不会进行覆盖
其余步骤和创建cookie一样</code></pre><blockquote>
<pre><code>Cookie ck = new Cookie(&quot;1&quot;,&quot;1&quot;)；
ck.setPath(&quot;/webs&quot;)；
ck.setMaxAge(60*60)；
resq.addCookie(ck)；</code></pre></blockquote>
<h3 id="Cookie编码与解码"><a href="#Cookie编码与解码" class="headerlink" title="Cookie编码与解码"></a>Cookie编码与解码</h3><pre><code>Cookie是不需要中文的，只能包含ASCII码，如果需要使用unicode，需要进行编码和解码    </code></pre><p><img src="/2020/09/19/servlet/charset.png" alt="编码异常"></p>
<pre><code>* 编码可以使用java.net.URLEncoder的encode(String str,String encoding)
* 解码可以使用java.net.URLDecoder的decode(String str,String encoding)</code></pre><h4 id="创建-读取带有中文的Cookie"><a href="#创建-读取带有中文的Cookie" class="headerlink" title="创建 读取带有中文的Cookie"></a>创建 读取带有中文的Cookie</h4><p><img src="/2020/09/19/servlet/encode_decode.png" alt></p>
<h3 id="Cookie的优点和缺点"><a href="#Cookie的优点和缺点" class="headerlink" title="Cookie的优点和缺点"></a>Cookie的优点和缺点</h3><pre><code>1. 优点：
    * 可以配置到期规则
    * 简单：基于文本结构，包含简单的键值对
    * 数据持久性：Cookie默认在到期之前可以一直存在于浏览器

2. 缺点
    * 数据大小受限制：一般浏览器的Cookie在4k,8k字节的限制
    * 用户配置为禁用，会限制Cookie的使用
    * cookie可能被篡改，对安全性造成威胁</code></pre><h2 id="Session对象"><a href="#Session对象" class="headerlink" title="Session对象"></a>Session对象</h2><h3 id="Session概述"><a href="#Session概述" class="headerlink" title="Session概述"></a>Session概述</h3><pre><code>1. Session用于记录用户的状态，是指在一段时间内，单个客户端与Web服务器的一连串相关的交互过程
2. 在一个Session中，一个用户可能会多次请求同一个资源，也有可能访问不同的服务器资源

Session的原理：
    * 服务器会为每一个会话分配一个Session对象
    * 同一个浏览器的多次请求，同属于一个会话
    * 首次使用Session时，服务器会创建Session，并创建Cookie存储SessionId发回服务器

Session对象是由服务器创建的，存储于服务器端</code></pre><h3 id="Session使用"><a href="#Session使用" class="headerlink" title="Session使用"></a>Session使用</h3><pre><code>1. Session作用域：拥有存储数据的空间，作用范围是一次会话
    * 一次会话，是使用同一个浏览器发送的多次请求，一旦浏览器关闭，则会话结束
    * 可以将数据存入Session,在一次会话的任意位置进行获取
    * 可以传递任意数据类型（基本数据，字符串，数组，集合等）</code></pre><h4 id="获取Session对象"><a href="#获取Session对象" class="headerlink" title="获取Session对象"></a>获取Session对象</h4><pre><code>在浏览器首次连接服务器时，服务器自动创建Session对象，并创建Cookie返回sessionId
//1.通过request对象获取Session对象</code></pre><p><code>HttpSession session = request.getSession();</code><br><code>System.out.println(session.getId());</code></p>
<h3 id="Session数据传递"><a href="#Session数据传递" class="headerlink" title="Session数据传递"></a>Session数据传递</h3><h4 id="保存数据"><a href="#保存数据" class="headerlink" title="保存数据"></a>保存数据</h4><pre><code>* setAttribute(属性名，Object)
    session.setAttribute(key,value);以键值对的形式存储数据</code></pre><h4 id="获取数据"><a href="#获取数据" class="headerlink" title="获取数据"></a>获取数据</h4><pre><code>* getAttribute(属性名)
    session.getAttribute(key);获取数据</code></pre><h4 id="移除数据"><a href="#移除数据" class="headerlink" title="移除数据"></a>移除数据</h4><pre><code>* removeAttribute(key)
    session.removeAttribute(key)</code></pre><h3 id="Session的生命周期"><a href="#Session的生命周期" class="headerlink" title="Session的生命周期"></a>Session的生命周期</h3><pre><code>* 开始：浏览器首次使用到Session的请求，会创建Session
* 结束：
        浏览器关闭，则无效
        Session超时，则无效（可以设置最大有效时间，单位秒）
            session.setMaxInactiveInter
        手工销毁，则失效
            session.invalidate();//退出登录，注销</code></pre><h3 id="Session超时设置"><a href="#Session超时设置" class="headerlink" title="Session超时设置"></a>Session超时设置</h3><pre><code>session.setMaxInactiveInterval(60);</code></pre><h3 id="禁用session解决"><a href="#禁用session解决" class="headerlink" title="禁用session解决"></a>禁用session解决</h3><pre><code>由于session是借助cookie来进行传递的，如果浏览器禁止cookie，浏览器不会接收session，在下一次连接的时候，会创建一个新的session

URL重写：
    浏览器在访问服务器的地址时，不再使用原来的地址，而是经过改写的地址，原来的地址后面增加了sessionId

实现：
    使用respone.encodeRedirectURL(String url)生成新的URL，根据是否禁用cookie来在尾部追加SessionId</code></pre><h3 id="Seeeion的案例"><a href="#Seeeion的案例" class="headerlink" title="Seeeion的案例"></a>Seeeion的案例</h3><pre><code>* 进行登录验证</code></pre><blockquote>
</blockquote>
<p><img src="/2020/09/19/servlet/session_exp_1.png" alt="Seeeion的案例_进行登录验证"></p>
<pre><code>* 进行邮箱验证</code></pre><blockquote>
</blockquote>
<p><img src="/2020/09/19/servlet/session_exp_2.png" alt="Seeeion的案例_进行登录验证"></p>
<h3 id="Request-Session的区别"><a href="#Request-Session的区别" class="headerlink" title="Request,Session的区别"></a>Request,Session的区别</h3><blockquote>
</blockquote>
<p><img src="/2020/09/19/servlet/request_session.png" alt="请求和会话"></p>
<h3 id="重定向和转发的区别"><a href="#重定向和转发的区别" class="headerlink" title="重定向和转发的区别"></a>重定向和转发的区别</h3><blockquote>
</blockquote>
<p><img src="/2020/09/19/servlet/redirect_forward.png" alt="重定向和转发"></p>
<h3 id="Cookie和Session"><a href="#Cookie和Session" class="headerlink" title="Cookie和Session"></a>Cookie和Session</h3><blockquote>
</blockquote>
<p><img src="/2020/09/19/servlet/cookie_session.png" alt="cookie session"></p>
<pre><code>* cookie和session都是保存浏览器访问服务器的状态，使用方式和存储位置不一样
* cookie存储的数据都是字符串，需要使用`respone.addCookie()`,将数据响应给浏览器，可以一次响应多个Cookie
* sesssion可以存储任意类型数据，直接`session.setAttribute()`,一个会话只有一个Session，一个SessionId</code></pre><h2 id="ServletContext对象"><a href="#ServletContext对象" class="headerlink" title="ServletContext对象"></a>ServletContext对象</h2><h3 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h3><pre><code>* 全局对象，拥有作用域，对应tomcat的一个web应用
* 当web服务器启动时，会为每一个web应用程序创建一个ServletContext对象，共享的存储区
* ServletContext在服务器启动的时候创建，服务器关闭的时候销毁</code></pre><h3 id="获取ServletContext"><a href="#获取ServletContext" class="headerlink" title="获取ServletContext"></a>获取ServletContext</h3><pre><code>1. 使用GenericServlet对象
    * getServletContext(),HttpServlet继承了GenericServlet,可以使用this.getServletContext()获取对象

2. HttPServletRequest对象
    * getServletContext()

3. HttpSession
    * getServletContext()</code></pre><h3 id="作用"><a href="#作用" class="headerlink" title="作用"></a>作用</h3><pre><code>1. 获取当前项目的真实路径：
    * context.getRealPath()

2. 获取项目的上下文名称：部署时的路径，项目的名称
    * context.getContextPath()

3. 全局容器 : 整个web应用都可以使用
    * 存储数据：setAttribute(string,object)
    * 获取数据：getAttribute(string)
    * 移除数据：removeAttribute(string)</code></pre><h3 id="ServletContext特点"><a href="#ServletContext特点" class="headerlink" title="ServletContext特点"></a>ServletContext特点</h3><pre><code>* 唯一性：一个项目只有一个ServletContext
* 生命周期：只要容器不关闭或者应用不卸载，servletContext一直存在</code></pre><h3 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h3><pre><code>1. 统计当前项目的访问次数</code></pre><blockquote>
</blockquote>
<p><img src="/2020/09/19/servlet/servletcontext_count.png" alt="servletcontext"></p>
<h2 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h2><pre><code>现有问题
    代码冗余，可以抽取代码，比如编码问题</code></pre><h3 id="概念-1"><a href="#概念-1" class="headerlink" title="概念"></a>概念</h3><pre><code>过滤器(Filter)是位于客户端和服务器目标资源的一道过滤技术</code></pre><blockquote>
</blockquote>
<p><img src="/2020/09/19/servlet/filter_exe.png" alt="过滤器的执行流程"></p>
<h3 id="filter作用"><a href="#filter作用" class="headerlink" title="filter作用"></a>filter作用</h3><pre><code>1. 执行在servlet之前，客户端发送请求的时候，会先经过过滤器，再到达目标资源；响应的时候，会根据执行流程再次反向执行filter
2. 可以解决多个servlet的代码冗余问题，编码处理，登录验证</code></pre><h3 id="filter的编写"><a href="#filter的编写" class="headerlink" title="filter的编写"></a>filter的编写</h3><pre><code>Servlet API提供了一个Filter接口，只要实现了这个接口，就会成为过滤器（Filter）</code></pre><h4 id="实现过程"><a href="#实现过程" class="headerlink" title="实现过程"></a>实现过程</h4><pre><code>1. 编写java的实现代码
2. 编写doFileter()方法
3. 让请求继续下去，使用FilterChain,拦截链
    filterChain.doFilter(req,resp):让请求继续下去

在响应的时候，也会将响应传递给过滤器，然后再传递给客户端</code></pre><h3 id="filter的配置"><a href="#filter的配置" class="headerlink" title="filter的配置"></a>filter的配置</h3><pre><code>1. 注解配置
    @WebFilter(value = &quot;/过滤的目标资源&quot;)

2. 在web.xml中配置filter
    使用filter filter-mapping</code></pre><h3 id="过滤器链和过滤优先级"><a href="#过滤器链和过滤优先级" class="headerlink" title="过滤器链和过滤优先级"></a>过滤器链和过滤优先级</h3><pre><code>1. 过滤器链
    * 客户端对服务器请求之后，服务器会执行一组过滤器，那么这组过滤器就叫做过滤器链。
    * 每个过滤器实现特定的功能当第一个过滤器的doFilter方法被调用的时候，web服务器会创建一个代表过滤器链的filterChain对象，在doFilter方法中，开发人员如果调用了`FilterChain`的`doFilter`方法，web服务器会检查是否还有其他的过滤器，如果还有，就会执行第二个过滤器，如果没有，就调用目标资源。

2. 过滤器链的优先级
    * 如果全是注解，会按照类全名称的字典顺序
    * 如果全是xml,按照filter的注册顺序，从上往下
    * 两者都有，xml的优先级高于注解
    * 同时配置，会执行多次过滤</code></pre><h3 id="filter拦截路径设置"><a href="#filter拦截路径设置" class="headerlink" title="filter拦截路径设置"></a>filter拦截路径设置</h3><pre><code>1. 精确拦截;
    /index.jsp
2. 后缀拦截:
    *.jsp，不需要加/
3. 通配符拦截
    /* ,/aaa/bbb/*
    不能使用/进行拦截</code></pre><h3 id="filter使用场景"><a href="#filter使用场景" class="headerlink" title="filter使用场景"></a>filter使用场景</h3><pre><code>1. 过滤器解决编码问题
    * 统一解决字符编码问题
2. 解决权限验证问题
    * 在过滤器中验证是否登录过服务器</code></pre><blockquote>
</blockquote>
<p><img src="/2020/09/19/servlet/errors_01.png" alt></p>

      
    </div>
    
    
    

    <div>
      
        
    <div style="text-align:center;color: #ccc;font-size:14px;">
        ------ 本文结束<i class="fa fa-paw"></i>感谢您的阅读 ------</div>

      
    </div>

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Servlet/" rel="tag"><i class="fa fa-tag"></i> Servlet</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        

        

        
          
          <div id="needsharebutton-postbottom">
            <span class="btn">
              <i class="fa fa-share-alt" aria-hidden="true"></i>
            </span>
          </div>
        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/09/18/ssm/" rel="next" title="SSM">
                <i class="fa fa-chevron-left"></i> SSM
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/09/26/servlet_path/" rel="prev" title="Servlet路径有关的问题">
                Servlet路径有关的问题 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      

      <div>
        <p id="div-border-left-red">
        <b>本文基于<a target="_blank" title="Creative Commons Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)" href="http://creativecommons.org/licenses/by-sa/4.0/"> 知识共享署名-相同方式共享 4.0 </a>国际许可协议发布</b><br/>
        <span>
          <b>本文地址: </b><a href="/2020/09/19/servlet/" title="Servlet">http://print3306.github.io/2020/09/19/servlet/</a><br/><b>转载请注明出处, 谢谢！</b>
        </span>
      </p>
</div>

    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar1.jpg"
                alt="浊酒一杯" />
            
              <p class="site-author-name" itemprop="name">浊酒一杯</p>
              <p class="site-description motion-element" itemprop="description">砥砺前行</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
                <a href="/archives">
                  <span class="site-state-item-count">27</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">15</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">13</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="mailto:3230372879qq.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-globe"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          
        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#概念"><span class="nav-number">1.</span> <span class="nav-text">概念</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#两种架构"><span class="nav-number">1.1.</span> <span class="nav-text">两种架构</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#服务器简介"><span class="nav-number">1.2.</span> <span class="nav-text">服务器简介</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet"><span class="nav-number">2.</span> <span class="nav-text">Servlet</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Servlet的基础概念"><span class="nav-number">2.1.</span> <span class="nav-text">Servlet的基础概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Servlet开发步骤"><span class="nav-number">2.2.</span> <span class="nav-text">Servlet开发步骤</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用IDEA开发部署Servlet"><span class="nav-number">2.3.</span> <span class="nav-text">使用IDEA开发部署Servlet</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#HTTP协议"><span class="nav-number">3.</span> <span class="nav-text">HTTP协议</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#HTTP"><span class="nav-number">3.1.</span> <span class="nav-text">HTTP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet深入"><span class="nav-number">4.</span> <span class="nav-text">Servlet深入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Servlet核心接口和类"><span class="nav-number">4.1.</span> <span class="nav-text">Servlet核心接口和类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Servlet的创建方式"><span class="nav-number">4.2.</span> <span class="nav-text">Servlet的创建方式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Servlet的配置方式"><span class="nav-number">4.3.</span> <span class="nav-text">Servlet的配置方式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet应用"><span class="nav-number">5.</span> <span class="nav-text">Servlet应用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Request对象"><span class="nav-number">5.1.</span> <span class="nav-text">Request对象</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#get请求"><span class="nav-number">5.1.1.</span> <span class="nav-text">get请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#post请求"><span class="nav-number">5.1.2.</span> <span class="nav-text">post请求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Request的常用方法"><span class="nav-number">5.1.3.</span> <span class="nav-text">Request的常用方法</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Request的应用"><span class="nav-number">5.1.4.</span> <span class="nav-text">Request的应用</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Respone对象"><span class="nav-number">6.</span> <span class="nav-text">Respone对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Resopne的主要方法"><span class="nav-number">6.1.</span> <span class="nav-text">Resopne的主要方法</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#响应数据给客户端"><span class="nav-number">6.1.1.</span> <span class="nav-text">响应数据给客户端</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#案例"><span class="nav-number">7.</span> <span class="nav-text">案例</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#转发（request）"><span class="nav-number">7.1.</span> <span class="nav-text">转发（request）</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#页面跳转"><span class="nav-number">7.1.1.</span> <span class="nav-text">页面跳转</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据传递"><span class="nav-number">7.1.2.</span> <span class="nav-text">数据传递</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#转发的注意事项"><span class="nav-number">7.1.3.</span> <span class="nav-text">转发的注意事项</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重定向"><span class="nav-number">7.2.</span> <span class="nav-text">重定向</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#页面跳转-1"><span class="nav-number">7.2.1.</span> <span class="nav-text">页面跳转</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据传递-1"><span class="nav-number">7.2.2.</span> <span class="nav-text">数据传递</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#重定向注意实项"><span class="nav-number">7.2.3.</span> <span class="nav-text">重定向注意实项</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Servlet的生命周期"><span class="nav-number">8.</span> <span class="nav-text">Servlet的生命周期</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#生命周期的四个阶段"><span class="nav-number">8.1.</span> <span class="nav-text">生命周期的四个阶段</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#实例化"><span class="nav-number">8.1.1.</span> <span class="nav-text">实例化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#初始化"><span class="nav-number">8.1.2.</span> <span class="nav-text">初始化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#服务"><span class="nav-number">8.1.3.</span> <span class="nav-text">服务</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#死亡"><span class="nav-number">8.1.4.</span> <span class="nav-text">死亡</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Servlet的特性"><span class="nav-number">8.2.</span> <span class="nav-text">Servlet的特性</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#线程安全问题"><span class="nav-number">8.2.1.</span> <span class="nav-text">线程安全问题</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#状态管理"><span class="nav-number">9.</span> <span class="nav-text">状态管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#现有问题"><span class="nav-number">9.1.</span> <span class="nav-text">现有问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#状态管理的概念"><span class="nav-number">9.2.</span> <span class="nav-text">状态管理的概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#状态管理的分类"><span class="nav-number">9.3.</span> <span class="nav-text">状态管理的分类</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Cookie的使用"><span class="nav-number">10.</span> <span class="nav-text">Cookie的使用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#什么是Cookie"><span class="nav-number">10.1.</span> <span class="nav-text">什么是Cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#创建Cookie"><span class="nav-number">10.2.</span> <span class="nav-text">创建Cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#获取Cookie"><span class="nav-number">10.3.</span> <span class="nav-text">获取Cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#修改Cookie"><span class="nav-number">10.4.</span> <span class="nav-text">修改Cookie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie编码与解码"><span class="nav-number">10.5.</span> <span class="nav-text">Cookie编码与解码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#创建-读取带有中文的Cookie"><span class="nav-number">10.5.1.</span> <span class="nav-text">创建 读取带有中文的Cookie</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie的优点和缺点"><span class="nav-number">10.6.</span> <span class="nav-text">Cookie的优点和缺点</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Session对象"><span class="nav-number">11.</span> <span class="nav-text">Session对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Session概述"><span class="nav-number">11.1.</span> <span class="nav-text">Session概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Session使用"><span class="nav-number">11.2.</span> <span class="nav-text">Session使用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#获取Session对象"><span class="nav-number">11.2.1.</span> <span class="nav-text">获取Session对象</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Session数据传递"><span class="nav-number">11.3.</span> <span class="nav-text">Session数据传递</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#保存数据"><span class="nav-number">11.3.1.</span> <span class="nav-text">保存数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#获取数据"><span class="nav-number">11.3.2.</span> <span class="nav-text">获取数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#移除数据"><span class="nav-number">11.3.3.</span> <span class="nav-text">移除数据</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Session的生命周期"><span class="nav-number">11.4.</span> <span class="nav-text">Session的生命周期</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Session超时设置"><span class="nav-number">11.5.</span> <span class="nav-text">Session超时设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#禁用session解决"><span class="nav-number">11.6.</span> <span class="nav-text">禁用session解决</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Seeeion的案例"><span class="nav-number">11.7.</span> <span class="nav-text">Seeeion的案例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Request-Session的区别"><span class="nav-number">11.8.</span> <span class="nav-text">Request,Session的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#重定向和转发的区别"><span class="nav-number">11.9.</span> <span class="nav-text">重定向和转发的区别</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Cookie和Session"><span class="nav-number">11.10.</span> <span class="nav-text">Cookie和Session</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ServletContext对象"><span class="nav-number">12.</span> <span class="nav-text">ServletContext对象</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概述"><span class="nav-number">12.1.</span> <span class="nav-text">概述</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#获取ServletContext"><span class="nav-number">12.2.</span> <span class="nav-text">获取ServletContext</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#作用"><span class="nav-number">12.3.</span> <span class="nav-text">作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ServletContext特点"><span class="nav-number">12.4.</span> <span class="nav-text">ServletContext特点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#应用场景"><span class="nav-number">12.5.</span> <span class="nav-text">应用场景</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#过滤器"><span class="nav-number">13.</span> <span class="nav-text">过滤器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念-1"><span class="nav-number">13.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#filter作用"><span class="nav-number">13.2.</span> <span class="nav-text">filter作用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#filter的编写"><span class="nav-number">13.3.</span> <span class="nav-text">filter的编写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#实现过程"><span class="nav-number">13.3.1.</span> <span class="nav-text">实现过程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#filter的配置"><span class="nav-number">13.4.</span> <span class="nav-text">filter的配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#过滤器链和过滤优先级"><span class="nav-number">13.5.</span> <span class="nav-text">过滤器链和过滤优先级</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#filter拦截路径设置"><span class="nav-number">13.6.</span> <span class="nav-text">filter拦截路径设置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#filter使用场景"><span class="nav-number">13.7.</span> <span class="nav-text">filter使用场景</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  
  <span class="author" itemprop="copyrightHolder">浊酒一杯</span>

  
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">40.6k</span>
  
</div>

<!--

  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>

-->



        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
      <div id="needsharebutton-float">
        <span class="btn">
          <i class="fa fa-share-alt" aria-hidden="true"></i>
        </span>
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  
  
  
  <link rel="stylesheet" href="/lib/needsharebutton/needsharebutton.css">

  
  
  <script src="/lib/needsharebutton/needsharebutton.js"></script>

  <script>
    
      pbOptions = {};
      
          pbOptions.iconStyle = "box";
      
          pbOptions.boxForm = "horizontal";
      
          pbOptions.position = "bottomCenter";
      
          pbOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-postbottom', pbOptions);
    
    
      flOptions = {};
      
          flOptions.iconStyle = "box";
      
          flOptions.boxForm = "vertical";
      
          flOptions.position = "topRight";
      
          flOptions.networks = "Weibo,Wechat,Douban,QQZone,Twitter,Facebook";
      
      new needShareButton('#needsharebutton-float', flOptions);
    
  </script>

  

  

  

  


  <!--鼠标点击心形效果-->
  <script type="text/javascript" src="/js/src/clicklove.js"></script>

  <!--mob_share-->
  
<script type="text/javascript">
    //微信二维码点击背景关闭
    $('body').delegate('.-mob-share-weixin-qrcode-bg','click', function(){
         $(".-mob-share-weixin-qrcode-close").trigger("click");
    }); 
</script>


  <!--动态线条背景 220,220,220 opacity='0.8' zIndex="-2"-->
  <script type="text/javascript"
    color="192,192,192" opacity='0.6' zIndex="-1" count="150" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js">
  </script>

  <!-- 代码复制 -->
  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #333;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #eee;
      background-image: linear-gradient(#fcfcfc, #eee);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>
  
  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('复制').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('复制成功')
          else $(this).text('复制失败')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('复制')
        }, 300)
      }).append(e)
    })
  </script>



  <!-- 雪花特效 
  <script type="text/javascript">
    var windowWidth = $(window).width();
    if (windowWidth > 480) {
      document.write('<script type="text/javascript" src="/js/src/snow.js"><、/script>');
    }
  </script>

  <script type="text/javascript" src="//libs.baidu.com/jquery/1.8.3/jquery.min.js"></script>-->

  <!-- 不蒜子统计 -->
  


<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>